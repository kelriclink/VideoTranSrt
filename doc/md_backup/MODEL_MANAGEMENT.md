# 模型管理功能说明

## 新增功能

### 1. 模型文件夹
- 在程序目录下创建了 `model` 文件夹用于存放 Whisper 模型
- 模型文件不再存储在系统临时目录，便于管理和备份

### 2. GUI 模型管理界面
- 在设置对话框中新增了"模型管理"标签页
- 可以查看所有可用模型的详细信息（大小、速度、准确性）
- 支持一键下载和删除模型
- 实时显示模型下载状态和磁盘使用情况

### 3. 模型路径配置
- 在"语音识别"标签页中可以自定义模型存储路径
- 支持浏览选择自定义路径
- 配置会自动保存到配置文件中

## 使用方法

### 通过 GUI 管理模型
1. 启动程序：`python run.py gui`
2. 点击"设置"按钮
3. 切换到"模型管理"标签页
4. 查看模型列表，点击"下载"按钮下载需要的模型
5. 已下载的模型可以点击"删除"按钮删除

### 通过命令行指定模型路径
```bash
# 设置环境变量指定模型路径
set WHISPER_CACHE_DIR=D:\your\custom\model\path
python run.py input.mp4
```

### 模型大小选择建议
- **tiny (39MB)**: 适合快速测试，准确性较低
- **base (74MB)**: 平衡速度和准确性，推荐日常使用
- **small (244MB)**: 较好准确性，推荐使用
- **medium (769MB)**: 高准确性，适合重要内容
- **large (1550MB)**: 最高准确性，适合专业用途

## 技术实现

### 新增文件
- `video2srt/model_manager.py`: 模型管理核心模块
- `model/`: 模型存储目录

### 修改文件
- `video2srt/transcriber.py`: 支持自定义模型路径
- `video2srt/config_manager.py`: 添加模型路径配置管理
- `video2srt/gui/config_dialog.py`: 新增模型管理界面
- `video2srt/core.py`: 使用新的模型路径功能
- `config/default_config.json`: 添加模型路径配置项

### 主要功能
1. **模型下载**: 使用多线程下载，支持进度回调
2. **模型管理**: 检查模型存在性、获取文件大小、删除模型
3. **路径配置**: 支持自定义模型存储路径
4. **磁盘监控**: 实时显示模型文件夹的磁盘使用情况

## 注意事项

1. **网络要求**: 首次下载模型需要网络连接
2. **磁盘空间**: 大模型需要较多磁盘空间，请确保有足够空间
3. **下载时间**: 大模型下载时间较长，请耐心等待
4. **SSL 问题**: 如果遇到 SSL 证书问题，程序会自动处理或提供解决建议

## 故障排除

### 模型下载失败
1. 检查网络连接
2. 设置环境变量：`set PYTHONHTTPSVERIFY=0`
3. 尝试使用代理或VPN
4. 手动下载模型文件到 model 文件夹

### 模型路径问题
1. 确保路径存在且有写入权限
2. 路径中不要包含中文字符
3. 使用绝对路径而不是相对路径

### 性能优化
1. 根据硬件配置选择合适的模型大小
2. 有 GPU 的用户推荐使用 small 或 medium 模型
3. 只有 CPU 的用户推荐使用 tiny 或 base 模型
